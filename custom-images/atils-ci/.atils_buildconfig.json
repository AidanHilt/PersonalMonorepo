{
  "actions": [
    {
      "name": "validate_buildconfig",
      "command": "check-jsonschema .atils_buildconfig.json --schemafile ../../json-schemas/atils_buildconfig.json",
      "order": 0
    },
    {
      "name": "build",
      "command": "source config.env; docker build . -t $IMAGE_NAME:$IMAGE_TAG -t $IMAGE_NAME:latest",
      "order": 10,
      "description": "Build the docker image"
    },
    {
      "name": "push",
      "command": "source config.env; docker push $IMAGE_NAME:$IMAGE_TAG",
      "order": 11,
      "description": "Push the docker image",
      "ci_only": true
    },
    {
      "name": "push-latest",
      "command": "source config.env; docker push $IMAGE_NAME:latest",
      "order": 12,
      "description": "Push the docker image with the latest tag",
      "ci_only": true
    }
  ],
  "action_sets": [
    {
      "name": "validate",
      "actions": [
        "validate_buildconfig"
      ],
      "default": true
    },
    {
      "name": "ci-build-publish",
      "actions": [
        "validate_buildconfig",
        "build",
        "push"
      ]
    }
  ]
}