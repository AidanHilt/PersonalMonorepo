{{- include "bjw-s.common.loader.init" . }}

{{/* Append the hardcoded settings */}}
{{- define "bar-assistant.harcodedValues" -}}
controllers:
  backend:
    type: deployment
    containers:
      bar-assistant:
        image:
          repository: {{ .Values.backendImage.repository }}
          pullPolicy: {{ .Values.backendImage.pullPolicy }}
          tag: {{ .Values.backendImage.tag }}
        env:
          MEILISEARCH_HOST: http://bar-assistant-meilisearch
  frontend:
    type: deployment
    containers:
      saltrim:
        image:
          repository: {{ .Values.frontendImage.repository }}
          pullPolicy: {{ .Values.frontendImage.pullPolicy }}
          tag: {{ .Values.frontendImage.tag }}
        env:
          API_URL: http://bar-assistant-api.qa-cluster-lb.lan/
          MEILISEARCH_URL: http://bar-assistant-meilisearch

{{- end -}}
{{- $_ := mergeOverwrite .Values (include "bar-assistant.harcodedValues" . | fromYaml) -}}
{{ include "bjw-s.common.loader.generate" . }}